<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Hive Connect — Alumni Dashboard</title>

<!-- FontAwesome + Chart.js -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  /* ---------------- Reset & base ---------------- */
  :root{
    --bg1:#1a1a2e;
    --bg2:#16213e;
    --bg3:#0f3460;
    --accent1:#e91e63;
    --accent2:#8b45c3;
    --glass: rgba(26,26,46,0.85);
    --glass-border: rgba(139,69,195,0.25);
    --muted: rgba(255,255,255,0.75);
    --card: rgba(26,26,46,0.65);
  }
  *{box-sizing:border-box;margin:0;padding:0;font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif}
  html,body{height:100%}
  body{
    min-height:100vh;
    background: linear-gradient(135deg,var(--bg1) 0%, var(--bg2) 50%, var(--bg3) 100%);
    color: #fff;
    -webkit-font-smoothing:antialiased;
  }

  /* ---------------- Layout ---------------- */
  .container{display:flex;min-height:100vh}
  .sidebar{
    width:280px; background: linear-gradient(180deg, rgba(26,26,46,0.95), rgba(18,18,30,0.95));
    border-right:1px solid var(--glass-border);
    backdrop-filter: blur(20px);
    padding:20px 16px; box-shadow:5px 0 20px rgba(0,0,0,0.35);
  }
  .logo{padding:18px 8px; border-bottom:1px solid rgba(139,69,195,0.08); text-align:center}
  .logo h2{color:var(--accent1); font-size:1.4rem; margin-bottom:4px}
  .logo p{color:rgba(255,255,255,0.65); font-size:0.9rem}

  .nav-menu{margin-top:18px}
  .nav-item{margin:8px 6px; border-radius:12px; overflow:hidden; transition:all 0.22s ease}
  .nav-item:hover{transform:translateX(6px); background:linear-gradient(90deg, rgba(139,69,195,0.07), rgba(220,20,60,0.06))}
  .nav-item .nav-link{display:flex;align-items:center;padding:12px 16px;color:rgba(255,255,255,0.88);text-decoration:none;font-weight:600}
  .nav-link i{width:22px;text-align:center;margin-right:12px;color:var(--accent1)}
  .nav-link .badge{margin-left:auto;background:linear-gradient(45deg,var(--accent1),var(--accent2));padding:0.2rem 0.6rem;border-radius:20px;font-weight:700;font-size:0.78rem}

  .main-content{flex:1;padding:28px;overflow:auto}

  /* Header */
  .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px}
  .header h1{font-size:2rem;background:linear-gradient(135deg,var(--accent1),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
  .search-box{position:relative}
  .search-box input{padding:10px 14px 10px 38px;border-radius:24px;border:1px solid rgba(139,69,195,0.25);background:rgba(26,26,46,0.7);color:#fff;width:320px}
  .search-box i{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--accent1)}

  /* Stats grid */
  .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin-bottom:18px}
  .stat-card{background:linear-gradient(135deg, rgba(26,26,46,0.9), rgba(22,33,62,0.9));border-radius:16px;padding:18px;border:1px solid var(--glass-border);position:relative;overflow:hidden; transition:all 0.25s}
  .stat-card:hover{transform:translateY(-8px);box-shadow:0 20px 40px rgba(139,69,195,0.14);border-color:var(--accent1)}
  .stat-card h3{font-size:0.85rem;color:rgba(255,255,255,0.85);letter-spacing:1px}
  .stat-card .number{font-size:1.9rem;font-weight:800;margin-top:6px}
  .stat-card .muted{color:rgba(255,255,255,0.6);font-size:0.9rem}

  /* Chart area */
  .chart-container{background:var(--card);padding:18px;border-radius:14px;border:1px solid var(--glass-border);margin-bottom:18px}

  /* Sections grid */
  .section-title{font-size:1.2rem;color:var(--accent2);margin-bottom:12px;font-weight:700}

  .features-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px;margin-bottom:16px}
  .feature-card{background:rgba(255,255,255,0.03);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
  .feature-header{display:flex;align-items:center;gap:10px;margin-bottom:8px}
  .feature-header i{font-size:1.1rem;color:var(--accent1)}
  .feature-content p{color:rgba(255,255,255,0.78);font-size:0.95rem;margin-bottom:10px}
  .btn{background:linear-gradient(45deg,var(--accent1),var(--accent2));color:#fff;border:none;padding:8px 14px;border-radius:999px;font-weight:700;cursor:pointer}
  .btn-outline{background:transparent;border:1px solid rgba(255,255,255,0.12);color:#fff;padding:8px 12px;border-radius:999px;cursor:pointer}

  /* Table */
  .data-table{width:100%;border-collapse:collapse;margin-top:10px}
  .data-table th, .data-table td{padding:10px;text-align:left;border-bottom:1px solid rgba(139,69,195,0.08)}
  .data-table th{background:rgba(139,69,195,0.06);color:#fff;font-weight:700}

  /* Group & Invitation card */
  .group-card{background:linear-gradient(135deg, rgba(26,26,46,0.6), rgba(22,33,62,0.6));padding:14px;border-radius:12px;border:1px solid rgba(139,69,195,0.12)}
  .group-header{display:flex;align-items:center;gap:12px}
  .group-avatar{width:50px;height:50px;border-radius:50%;background:linear-gradient(135deg,var(--accent1),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:800}

  /* Modal */
  .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:1200;align-items:center;justify-content:center}
  .modal.active{display:flex}
  .modal-content{background:linear-gradient(135deg, rgba(26,26,46,0.98), rgba(22,33,62,0.98));padding:18px;border-radius:14px;width:96%;max-width:620px;border:1px solid rgba(139,69,195,0.2)}

  .form-group{margin-bottom:12px}
  .form-group label{display:block;margin-bottom:6px;color:rgba(255,255,255,0.85)}
  .form-group input, .form-group textarea, .form-group select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(139,69,195,0.15);background:rgba(26,26,46,0.6);color:#fff}

  .form-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:12px}

  /* Chatbot floating + box */
  .chatbot-btn{position:fixed;right:18px;bottom:18px;background:linear-gradient(45deg,var(--accent1),var(--accent2));padding:12px 16px;border-radius:28px;box-shadow:0 10px 30px rgba(0,0,0,0.3);z-index:1300;cursor:pointer;display:flex;align-items:center;gap:10px}
  .chatbox{position:fixed;right:18px;bottom:80px;width:360px;max-height:70vh;background:#fff;border-radius:12px;overflow:hidden;display:none;flex-direction:column;z-index:1301}
  .chatbox.active{display:flex}
  .chat-header{background:linear-gradient(135deg,var(--accent1),var(--accent2));color:#fff;padding:10px;display:flex;align-items:center;justify-content:space-between}
  .chat-body{padding:12px;overflow:auto;background:#f6f7fb;color:#222;flex:1}
  .chat-footer{display:flex;padding:12px;gap:8px;background:#fff}
  .chat-input{flex:1;padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.08)}

  /* small */
  @media(max-width:900px){
    .sidebar{width:100%;position:static;border-right:none;border-bottom:1px solid rgba(139,69,195,0.06);display:flex;flex-wrap:wrap}
    .container{margin-left:0;padding:14px}
    .search-box input{width:220px}
  }
</style>
</head>
<body>

<div class="container">

  <!-- Sidebar -->
  <aside class="sidebar" aria-label="Main navigation">
    <div class="logo">
      <h2><i class="fas fa-hexagon"></i> Hive Connect</h2>
      <p>Alumni Network</p>
    </div>

   <!-- Sidebar -->
<nav class="nav-menu" aria-label="Sidebar menu">
  <div class="nav-item"><a href="#" class="nav-link active" data-target="dashboard"><i class="fas fa-chart-line"></i> Dashboard</a></div>
  <div class="nav-item"><a href="#" class="nav-link" data-target="profile"><i class="fas fa-user"></i> Profile</a></div>
  <div class="nav-item"><a href="#" class="nav-link" data-target="events"><i class="fas fa-calendar-alt"></i> Events <span class="badge">5</span></a></div>
  <div class="nav-item"><a href="#" class="nav-link" data-target="careers"><i class="fas fa-briefcase"></i> Careers</a></div>
  <div class="nav-item"><a href="#" class="nav-link" data-target="chatgroups"><i class="fas fa-comments"></i> Chat Groups</a></div>
  <div class="nav-item"><a href="#" class="nav-link" data-target="donations"><i class="fas fa-hand-holding-heart"></i> Donations</a></div>
  <div class="nav-item"><a href="#" class="nav-link" data-target="settings"><i class="fas fa-cog"></i> Settings</a></div>
</nav>

    <div style="margin-top:auto;padding:10px;font-size:0.9rem;color:rgba(255,255,255,0.7)">
      Logged in as <strong>Alumni User</strong>
    </div>
  </aside>

  <!-- Main content -->
  <main class="main-content">

    <!-- HEADER -->
   <!-- HEADER -->
<div class="header">
  <div>
    <h1>Alumni Dashboard</h1>
    <div style="color:rgba(255,255,255,0.6)">Manage events, donations and communication</div>
  </div>
  <div style="display:flex;align-items:center;gap:12px">
    <div class="search-box"><i class="fas fa-search"></i><input id="globalSearch" placeholder="Search..."></div>
    <!-- Removed "Add Alumni" button since directory is gone -->
  </div>
</div>


    <!-- Dashboard Page -->
    <section id="dashboard" class="page active">
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Total Alumni</h3>
          <div class="number" id="statTotal">1,200</div>
          <div class="muted">↗ +12% from last month</div>
        </div>
        <div class="stat-card">
          <h3>Donations Collected</h3>
          <div class="number" id="statDonations">₹ 6,45,000</div>
          <div class="muted">↗ +18% from last month</div>
        </div>
        <div class="stat-card">
          <h3>Upcoming Events</h3>
          <div class="number" id="statEvents">5</div>
          <div class="muted">→ Same as last month</div>
        </div>
        <div class="stat-card">
          <h3>Active Groups</h3>
          <div class="number" id="statGroups">12</div>
          <div class="muted">↗ +3 new groups</div>
        </div>
      </div>

      <div class="chart-container">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
          <div class="section-title">User Growth</div>
          <div style="color:rgba(255,255,255,0.7)">Monthly signups</div>
        </div>
        <canvas id="growthChart" height="120"></canvas>
      </div>

      <div style="display:grid;grid-template-columns:1fr 420px;gap:18px">
        <div>
          <div class="section-title">Latest Announcements</div>
          <div id="announcementsList">
            <!-- populated by JS -->
          </div>
        </div>

        <aside style="min-width:320px">
          <div class="section-title">Quick Actions</div>
          <div class="features-grid" style="grid-template-columns:1fr">
            <div class="feature-card">
              <div class="feature-header"><i class="fas fa-envelope-open-text"></i><strong> Invitations</strong></div>
              <div class="feature-content"><p>Manage event invites, RSVP, and send reminders.</p>
              <button class="btn" onclick="openPage('events')">Manage Events</button></div>
            </div>

            <div class="feature-card">
              <div class="feature-header"><i class="fas fa-robot"></i><strong> AI Chat</strong></div>
              <div class="feature-content"><p>Quick help for admins & alumni — demo assistant.</p>
              <button class="btn" id="openChatBtn">Open Chat</button></div>
            </div>
          </div>
        </aside>
      </div>
    </section>

    <!-- PROFILE PAGE -->
    <section id="profile" class="page" style="display:none">
      <div class="section-title">Profile Management</div>
      <div style="display:flex;gap:16px;flex-wrap:wrap">
        <div class="feature-card" style="flex:1;min-width:320px">
          <div class="feature-header"><i class="fas fa-user-circle"></i> Personal Info</div>
          <form id="profileForm">
            <div class="form-group"><label>Full Name</label><input id="pfName" type="text"></div>
            <div class="form-group"><label>Email</label><input id="pfEmail" type="email"></div>
            <div class="form-group"><label>Phone</label><input id="pfPhone" type="text"></div>
            <div class="form-group"><label>Batch / Graduation Year</label><input id="pfBatch" type="text"></div>
            <div class="form-actions"><button class="btn" type="button" onclick="saveProfile()">Save</button></div>
          </form>
        </div>

        <div class="feature-card" style="width:360px">
          <div class="feature-header"><i class="fas fa-award"></i> Achievements</div>
          <div class="feature-content">
            <p id="profileAchievements">No achievements yet. Add your top accomplishments to stand out.</p>
            <button class="btn-outline" onclick="alert('Achievement flow demo')">Add Achievement</button>
          </div>
        </div>
      </div>
   

    <!-- EVENTS PAGE -->
    <section id="events" class="page" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div class="section-title">Events</div>
        <div><button class="btn" onclick="openAddEventModal()">Add Event</button></div>
      </div>

      <div style="margin-top:12px;display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px" id="eventsGrid">
        <!-- event cards via JS -->
      </div>

      <div style="margin-top:18px">
        <div class="section-title">Past RSVPs</div>
        <table class="data-table">
          <thead><tr><th>Event</th><th>Date</th><th>RSVP Status</th></tr></thead>
          <tbody id="rsvpTableBody"></tbody>
        </table>
      </div>
    </section>

    <!-- CAREERS PAGE -->
    <section id="careers" class="page" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div class="section-title">Jobs & Mentorship</div>
        <div><button class="btn" onclick="openAddJobModal()">Post Job</button></div>
      </div>

      <div style="margin-top:12px">
        <table class="data-table" id="jobsTable">
          <thead><tr><th>Role</th><th>Company</th><th>Location</th><th>Type</th><th>Apply</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- CHAT GROUPS PAGE -->
    <section id="chatgroups" class="page" style="display:none">
      <div class="section-title">Chat Groups</div>
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px">
        <div class="group-card">
          <div class="group-header"><div class="group-avatar">B</div><div><strong>Batch of 2018</strong><div style="font-size:0.9rem;color:rgba(255,255,255,0.7)">200 members</div></div></div>
          <div style="margin-top:10px"><button class="btn" onclick="alert('Joined group: Batch of 2018')">Join Group</button></div>
        </div>

        <div class="group-card">
          <div class="group-header"><div class="group-avatar">M</div><div><strong>Mentorship Program</strong><div style="font-size:0.9rem;color:rgba(255,255,255,0.7)">50 mentors</div></div></div>
          <div style="margin-top:10px"><button class="btn" onclick="alert('Joined Mentorship group')">Join</button></div>
        </div>
      </div>
    </section>

    <!-- DONATIONS PAGE -->
    <section id="donations" class="page" style="display:none">
      <div class="section-title">Donations & Campaigns</div>
      <div style="display:grid;grid-template-columns:1fr 320px;gap:16px;align-items:start">
        <div>
          <div class="feature-card">
            <div class="feature-header"><i class="fas fa-hand-holding-heart"></i><strong> Scholarship Fund</strong></div>
            <div class="feature-content"><p>Support bright students. Target: ₹1,000,000</p>
              <div class="donation-progress" style="background:rgba(139,69,195,0.12);height:12px;border-radius:8px;overflow:hidden"><div id="donationFill" style="height:100%;width:64%;background:linear-gradient(90deg,var(--accent1),var(--accent2));"></div></div>
              <div style="margin-top:10px;display:flex;gap:8px"><button class="btn" onclick="donate(5000)">Donate ₹5,000</button><button class="btn-outline" onclick="donate(1000)">Donate ₹1,000</button></div>
            </div>
          </div>

          <div style="margin-top:12px" class="feature-card">
            <div class="feature-header"><i class="fas fa-chart-line"></i> Donation History</div>
            <div class="feature-content"><table class="data-table" id="donationHistoryTable"><thead><tr><th>Donor</th><th>Amount</th><th>Date</th></tr></thead><tbody></tbody></table></div>
          </div>
        </div>

        <aside>
          <div class="feature-card">
            <div class="feature-header"><i class="fas fa-clipboard-list"></i> Campaigns</div>
            <div class="feature-content"><p>List and manage fundraising campaigns.</p><button class="btn-outline" onclick="alert('Open campaigns manager')">Manage Campaigns</button></div>
          </div>
        </aside>
      </div>
    </section>

   

    <!-- SETTINGS PAGE -->
    <section id="settings" class="page" style="display:none">
      <div class="section-title">Settings</div>
      <div class="feature-card" style="max-width:720px">
        <form id="settingsForm">
          <div class="form-group"><label>Notification Preferences</label><select id="prefNotification"><option>Email & App</option><option>Email Only</option><option>App Only</option></select></div>
          <div class="form-group"><label>Privacy</label><select id="prefPrivacy"><option>Public</option><option>Alumni only</option><option>Private</option></select></div>
          <div class="form-actions"><button class="btn" type="button" onclick="saveSettings()">Save Settings</button></div>
        </form>
      </div>
    </section>

  </main>
</div>

<!-- Floating Chatbot button + Chatbox -->
<div class="chatbot-btn" id="chatbotToggle"><i class="fas fa-robot"></i> Chat</div>
<div class="chatbox" id="chatbox">
  <div class="chat-header"><div style="display:flex;gap:8px;align-items:center"><i class="fas fa-robot"></i> Hive AI</div><div style="cursor:pointer" id="closeChat">✕</div></div>
  <div class="chat-body" id="chatBody"><div class="chat-msg in">Hi — I'm Hive AI. Ask about events, donations, or how to use the portal.</div></div>
  <div class="chat-footer"><input id="chatInput" class="chat-input" placeholder="Type a question..."><button class="btn" id="sendChatBtn">Send</button></div>
</div>

<!-- Modals -->
<div class="modal" id="alumniModal"><div class="modal-content">
  <div style="display:flex;justify-content:space-between;align-items:center"><h3>Add / Edit Alumni</h3><button class="closeModal btn-outline" onclick="closeModal('alumniModal')">Close</button></div>
  <form id="alumniForm" style="margin-top:12px">
    <div class="form-group"><label>Name</label><input id="aName" required></div>
    <div class="form-group"><label>Batch</label><input id="aBatch"></div>
    <div class="form-group"><label>Department</label><input id="aDept"></div>
    <div class="form-group"><label>Company</label><input id="aCompany"></div>
    <div class="form-group"><label>Location</label><input id="aLocation"></div>
    <div class="form-actions"><button class="btn" type="button" onclick="saveAlumni()">Save</button></div>
  </form>
</div></div>

<div class="modal" id="eventModal"><div class="modal-content">
  <div style="display:flex;justify-content:space-between;align-items:center"><h3>Create Event</h3><button class="closeModal btn-outline" onclick="closeModal('eventModal')">Close</button></div>
  <form id="eventForm" style="margin-top:12px">
    <div class="form-group"><label>Event Title</label><input id="evTitle"></div>
    <div class="form-group"><label>Date</label><input id="evDate" type="date"></div>
    <div class="form-group"><label>Location</label><input id="evLocation"></div>
    <div class="form-group"><label>Description</label><textarea id="evDesc" rows="3"></textarea></div>
    <div class="form-actions"><button class="btn" type="button" onclick="saveEvent()">Create</button></div>
  </form>
</div></div>

<div class="modal" id="jobModal"><div class="modal-content">
  <div style="display:flex;justify-content:space-between;align-items:center"><h3>Post Job</h3><button class="closeModal btn-outline" onclick="closeModal('jobModal')">Close</button></div>
  <form id="jobForm" style="margin-top:12px">
    <div class="form-group"><label>Role</label><input id="jobRole"></div>
    <div class="form-group"><label>Company</label><input id="jobCompany"></div>
    <div class="form-group"><label>Location</label><input id="jobLocation"></div>
    <div class="form-group"><label>Type</label><select id="jobType"><option>Full-time</option><option>Internship</option><option>Remote</option></select></div>
    <div class="form-actions"><button class="btn" type="button" onclick="saveJob()">Post</button></div>
  </form>
</div></div>

<script>
/* ---------------- Data (placeholder) ---------------- */
let alumni = [
  {id:1,name:'John Smith',batch:'2020',dept:'Computer Science',company:'Google',location:'Bengaluru',status:'Active'},
  {id:2,name:'Sarah Johnson',batch:'2019',dept:'Electrical Engineering',company:'Tesla',location:'Mumbai',status:'Active'},
  {id:3,name:'Mike Wilson',batch:'2018',dept:'Mechanical Engineering',company:'SpaceX',location:'Hyderabad',status:'Inactive'}
];

let events = [
  {id:1,title:'Annual Alumni Meet 2025',date:'2025-12-15',location:'Main Campus',desc:'Celebrate and network.',rsvps:45},
  {id:2,title:'Mentorship Program Kickoff',date:'2025-10-01',location:'Auditorium',desc:'Mentorship for juniors',rsvps:80}
];

let jobs = [
  {id:1,role:'Software Engineer',company:'TechCorp',location:'Bengaluru',type:'Full-time'},
  {id:2,role:'Data Analyst',company:'DataWorld',location:'Delhi',type:'Full-time'}
];

let announcements = [
  {sender:'Admin Team',time:'September 8, 2025',content:"Welcome to the new alumni portal! Please update your profile information."},
  {sender:'Career Services',time:'September 5, 2025',content:"Virtual career fair on October 15th. Register to connect with employers."}
];

let donationTotal = 645000;
let donationHistory = [
  {donor:'Rahul Sharma',amount:5000,date:'2025-08-12'},
  {donor:'Priya Singh',amount:2000,date:'2025-08-15'}
];

let rsvps = []; // store {eventId, name, status}

/* ---------------- Utilities & UI rendering ---------------- */
function htmlEscape(s){ return String(s).replace(/[&<>"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c])); }

function openPage(id){
  document.querySelectorAll('.nav-link').forEach(n=>n.classList.remove('active'));
  document.querySelectorAll('.page').forEach(p=>p.style.display='none');
  const el = document.getElementById(id);
  if(el) el.style.display='block';
  // highlight sidebar
  document.querySelectorAll('.nav-link[data-target]').forEach(a=>{
    if(a.getAttribute('data-target')===id) a.classList.add('active');
    else a.classList.remove('active');
  });
  // reset scroll top
  window.scrollTo({top:0,behavior:'smooth'});
  // refresh table/data if needed
  if(id==='directory') renderAlumniTable();
  if(id==='events') renderEvents();
  if(id==='careers') renderJobs();
  if(id==='donations') renderDonations();
  if(id==='analytics') updateAnalytics();
}

/* sidebar click handlers */
document.querySelectorAll('.nav-link').forEach(a=>{
  a.addEventListener('click', function(e){
    e.preventDefault();
    const t = this.getAttribute('data-target');
    if(t) openPage(t);
  });
});

/* search global */
document.getElementById('globalSearch').addEventListener('input', function(){
  const q = this.value.trim().toLowerCase();
  if(!q) return;
  // quick search in alumni
  const found = alumni.filter(x=> (x.name + ' ' + x.company + ' ' + x.location).toLowerCase().includes(q));
  if(found.length) {
    openPage('directory');
    document.getElementById('dirSearch').value = q;
    renderAlumniTable();
  }
});

/* announcements */
function renderAnnouncements(){
  const container = document.getElementById('announcementsList');
  container.innerHTML = '';
  announcements.forEach(a=>{
    const div = document.createElement('div');
    div.className = 'feature-card';
    div.innerHTML = `<div style="display:flex;justify-content:space-between"><div><strong>${htmlEscape(a.sender)}</strong><div style="color:rgba(255,255,255,0.7);font-size:0.9rem">${htmlEscape(a.time)}</div></div></div>
      <div style="margin-top:8px;color:rgba(255,255,255,0.85)">${htmlEscape(a.content)}</div>`;
    container.appendChild(div);
  });
}

/* Growth Chart */
const growthCtx = document.getElementById('growthChart').getContext('2d');
const growthChart = new Chart(growthCtx, {
  type:'line',
  data:{
    labels:['Jan','Feb','Mar','Apr','May','Jun','Jul'],
    datasets:[{
      label:'Users',
      data:[20,35,55,80,120,160,210],
      borderColor:'#e91e63',
      backgroundColor:'rgba(233,30,99,0.12)',
      tension:0.3,
      pointRadius:4,
      pointBackgroundColor:'#e91e63'
    }]
  },
  options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}
});

/* Activity Chart */
const activityCtx = document.getElementById('activityChart').getContext('2d');
let activityChart = new Chart(activityCtx, {
  type:'bar',
  data:{
    labels:['2019','2020','2021','2022','2023','2024'],
    datasets:[{label:'Alumni Joined', data:[120,150,200,240,300,350], backgroundColor:'#8b45c3'}]
  },
  options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}
});

/* Directory rendering & search */
function renderAlumniTable(){
  const tbody = document.querySelector('#alumniTable tbody');
  tbody.innerHTML = '';
  const q = (document.getElementById('dirSearch').value || '').toLowerCase();
  const list = alumni.filter(a=> !q || (a.name+' '+a.company+' '+a.location+' '+a.dept).toLowerCase().includes(q));
  list.forEach(a=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${htmlEscape(a.name)}</td>
      <td>${htmlEscape(a.batch)}</td>
      <td>${htmlEscape(a.dept)}</td>
      <td>${htmlEscape(a.company)}</td>
      <td>${htmlEscape(a.location)}</td>
      <td><span style="padding:6px 10px;border-radius:999px;background:${a.status==='Active'?'rgba(76,175,80,0.12)':'rgba(244,67,54,0.12)'};color:${a.status==='Active'?'#4caf50':'#f44336'}">${a.status}</span></td>
      <td><button class="btn-outline" onclick="editAlumni(${a.id})">Edit</button>&nbsp;<button class="btn-outline" onclick="deleteAlumni(${a.id})">Delete</button></td>`;
    tbody.appendChild(tr);
  });
}

/* Add/Edit alumni modal */
let editingAlumniId = null;
function openAddAlumniModal(){
  editingAlumniId = null;
  document.getElementById('aName').value = '';
  document.getElementById('aBatch').value = '';
  document.getElementById('aDept').value = '';
  document.getElementById('aCompany').value = '';
  document.getElementById('aLocation').value = '';
  document.getElementById('alumniModal').classList.add('active');
}
function editAlumni(id){
  const a = alumni.find(x=>x.id===id);
  if(!a) return alert('Not found');
  editingAlumniId = id;
  document.getElementById('aName').value = a.name;
  document.getElementById('aBatch').value = a.batch;
  document.getElementById('aDept').value = a.dept;
  document.getElementById('aCompany').value = a.company;
  document.getElementById('aLocation').value = a.location;
  document.getElementById('alumniModal').classList.add('active');
}
function saveAlumni(){
  const name = document.getElementById('aName').value.trim();
  if(!name) return alert('Name required');
  const rec = {id: editingAlumniId||Date.now(), name, batch:document.getElementById('aBatch').value, dept:document.getElementById('aDept').value, company:document.getElementById('aCompany').value, location:document.getElementById('aLocation').value, status:'Active'};
  if(editingAlumniId){
    const idx = alumni.findIndex(x=>x.id===editingAlumniId);
    alumni[idx] = rec;
  } else { alumni.unshift(rec); }
  closeModal('alumniModal'); renderAlumniTable(); updateStats();
}
function deleteAlumni(id){
  if(!confirm('Delete this alumni?')) return;
  alumni = alumni.filter(x=>x.id!==id);
  renderAlumniTable(); updateStats();
}
function closeModal(id){ document.getElementById(id).classList.remove('active'); }

/* Events */
function renderEvents(){
  const grid = document.getElementById('eventsGrid'); grid.innerHTML='';
  events.forEach(ev=>{
    const card = document.createElement('div'); card.className='feature-card';
    card.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center"><div><strong>${htmlEscape(ev.title)}</strong><div style="color:rgba(255,255,255,0.7);font-size:0.9rem">${ev.date} • ${htmlEscape(ev.location)}</div></div><div style="text-align:right"><div style="font-weight:800">${ev.rsvps}</div><div style="font-size:0.8rem;color:rgba(255,255,255,0.6)">RSVPs</div></div></div>
      <p style="margin-top:10px;color:rgba(255,255,255,0.8)">${htmlEscape(ev.desc)}</p>
      <div style="display:flex;gap:8px;margin-top:10px"><button class="btn" onclick="openRSVP(${ev.id})">RSVP</button><button class="btn-outline" onclick="viewEvent(${ev.id})">View</button></div>`;
    grid.appendChild(card);
  });

  // populate rsvp table
  const rtb = document.getElementById('rsvpTableBody'); rtb.innerHTML='';
  rsvps.forEach(r=>{ const ev=events.find(e=>e.id===r.eventId); if(ev){ const tr=document.createElement('tr'); tr.innerHTML=`<td>${htmlEscape(ev.title)}</td><td>${ev.date}</td><td>${htmlEscape(r.status)}</td>`; rtb.appendChild(tr);} });
}

function openAddEventModal(){ document.getElementById('eventModal').classList.add('active'); }
function saveEvent(){
  const t = document.getElementById('evTitle').value.trim(); if(!t) return alert('Title required');
  const d = document.getElementById('evDate').value; const loc=document.getElementById('evLocation').value; const desc=document.getElementById('evDesc').value;
  events.unshift({id:Date.now(), title:t, date:d, location:loc, desc, rsvps:0});
  closeModal('eventModal'); renderEvents(); updateStats();
}
function openRSVP(evId){
  const name = prompt('Enter your full name to RSVP:');
  if(!name) return;
  rsvps.push({eventId:evId, name, status:'Attending'});
  const ev = events.find(e=>e.id===evId); if(ev) ev.rsvps++;
  renderEvents(); alert('RSVP successful — thank you!');
}

/* Jobs */
function renderJobs(){
  const tbody = document.querySelector('#jobsTable tbody'); tbody.innerHTML='';
  jobs.forEach(j=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${htmlEscape(j.role)}</td><td>${htmlEscape(j.company)}</td><td>${htmlEscape(j.location)}</td><td>${htmlEscape(j.type)}</td><td><button class="btn-outline" onclick="applyJob(${j.id})">Apply</button></td>`;
    tbody.appendChild(tr);
  });
}
function openAddJobModal(){ document.getElementById('jobModal').classList.add('active'); }
function saveJob(){
  const role=document.getElementById('jobRole').value.trim(); if(!role) return alert('Role required');
  jobs.unshift({id:Date.now(), role, company:document.getElementById('jobCompany').value, location:document.getElementById('jobLocation').value, type:document.getElementById('jobType').value});
  closeModal('jobModal'); renderJobs();
}
function applyJob(id){ alert('Application submitted (demo).'); }

/* Donations */
function renderDonations(){
  document.querySelector('#donationHistoryTable tbody').innerHTML = donationHistory.map(d=>`<tr><td>${htmlEscape(d.donor)}</td><td>₹ ${d.amount.toLocaleString()}</td><td>${d.date}</td></tr>`).join('');
  const pct = Math.min(100, Math.round((donationTotal/1000000)*100));
  document.getElementById('donationFill').style.width = pct + '%';
}
function donate(amount){
  const donor = prompt('Enter your name:'); if(!donor) return;
  donationTotal += amount; donationHistory.unshift({donor,amount,date:new Date().toLocaleDateString()});
  renderDonations(); alert('Thanks for donating ₹' + amount.toLocaleString());
}

/* Analytics update */
function updateAnalytics(){
  const sel = document.getElementById('analyticsRange').value;
  // demo randomize
  activityChart.data.datasets[0].data = [150, 180, 210, 260, 300, Math.floor(Math.random()*200)+200];
  activityChart.update();
}

/* Settings & profile */
function saveProfile(){
  const n=document.getElementById('pfName').value; const em=document.getElementById('pfEmail').value;
  alert('Profile saved (demo): ' + (n||'Unnamed') + ' / ' + (em||'no-email'));
}
function saveSettings(){ alert('Settings saved (demo)'); }

/* Edit helpers */
function viewEvent(id){ const e = events.find(x=>x.id===id); if(!e) return; alert(e.title + '\\n\\n' + e.desc); }

/* Stats update */
function updateStats(){
  document.getElementById('statTotal').textContent = alumni.length;
  document.getElementById('statEvents').textContent = events.length;
  document.getElementById('statGroups').textContent = 12; // placeholder
  document.getElementById('statDonations').textContent = '₹ ' + donationTotal.toLocaleString();
}

/* Chatbot (demo) */
document.getElementById('chatbotToggle').addEventListener('click', ()=>{ document.getElementById('chatbox').classList.add('active'); });
document.getElementById('closeChat').addEventListener('click', ()=>{ document.getElementById('chatbox').classList.remove('active'); });
document.getElementById('sendChatBtn').addEventListener('click', sendChatMessage);
document.getElementById('chatInput').addEventListener('keypress', e=>{ if(e.key==='Enter') sendChatMessage(); });

function sendChatMessage(){
  const val = document.getElementById('chatInput').value.trim(); if(!val) return;
  const body = document.getElementById('chatBody');
  const out = document.createElement('div'); out.className='chat-msg out'; out.textContent = val; body.appendChild(out);
  document.getElementById('chatInput').value='';
  body.scrollTop = body.scrollHeight;
  // naive demo replies
  setTimeout(()=>{
    const inmsg = document.createElement('div'); inmsg.className='chat-msg in';
    if(/event|rsvp|register/i.test(val)) inmsg.textContent = 'You can RSVP on the Events page. Which event do you want to join?';
    else if(/donat|fund|scholar/i.test(val)) inmsg.textContent = 'To donate, go to Donations and choose an amount. We accept all major methods (demo).';
    else if(/profile|edit/i.test(val)) inmsg.textContent = 'Go to Profile to update your information. Need help changing a field?';
    else inmsg.textContent = "Demo assistant: here's a quick answer — for more details please check the relevant section.";
    body.appendChild(inmsg); body.scrollTop = body.scrollHeight;
  },700);
}

/* Quick bindings */
document.getElementById('openChatBtn').addEventListener('click', ()=>{ document.getElementById('chatbox').classList.add('active'); });
document.getElementById('openAddAlumniBtn').addEventListener('click', openAddAlumniModal);

/* Modal close by overlay */
document.querySelectorAll('.modal').forEach(m=>m.addEventListener('click', function(e){ if(e.target===this) this.classList.remove('active'); }));
document.querySelectorAll('.closeModal').forEach(b=>b.addEventListener('click', ()=>{ this.closest('.modal').classList.remove('active'); }));

/* Initial renders */
renderAnnouncements();
renderAlumniTable();
renderEvents();
renderJobs();
renderDonations();
updateStats();
updateAnalytics();

/* Directory search binding */
document.getElementById('dirSearch').addEventListener('input', renderAlumniTable);

/* Simple keyboard shortcuts (H = dashboard, D = directory, E = events) */
document.addEventListener('keydown', (e)=>{ if(e.key==='h') openPage('dashboard'); if(e.key==='d') openPage('directory'); if(e.key==='e') openPage('events'); });

</script>
</body>
</html>
